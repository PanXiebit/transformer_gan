nohup: ignoring input
INFO:tensorflow:flags_obj.model_dir
INFO:tensorflow:source vocab size:28333, target vocab size:29791
WARNING:tensorflow:From /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/utils/dataset.py:41: parallel_interleave (from tensorflow.contrib.data.python.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.experimental.parallel_interleave(...)`.
WARNING:tensorflow:From /home/work/venv/xie_py3.6/lib/python3.6/site-packages/tensorflow/python/ops/sparse_ops.py:1165: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
WARNING:tensorflow:From /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/utils/dataset.py:124: group_by_window (from tensorflow.contrib.data.python.ops.grouping) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.experimental.group_by_window(...)`.
INFO:tensorflow:Build graph on gpu:0
WARNING:tensorflow:From /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/model/beam_search.py:420: calling reduce_logsumexp (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
INFO:tensorflow:roll_num: 0
INFO:tensorflow:roll_num: 1
INFO:tensorflow:roll_num: 2
INFO:tensorflow:roll_num: 3
INFO:tensorflow:roll_num: 4
/home/work/venv/xie_py3.6/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py:112: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
INFO:tensorflow:total trainable variables number: 127, 127
INFO:tensorflow:Build graph on gpu:1
INFO:tensorflow:roll_num: 0
INFO:tensorflow:roll_num: 1
INFO:tensorflow:roll_num: 2
INFO:tensorflow:roll_num: 3
INFO:tensorflow:roll_num: 4
INFO:tensorflow:total trainable variables number: 127, 127
2019-09-24 13:41:06.407261: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-09-24 13:41:08.180678: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-24 13:41:08.184677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:db:00.0
totalMemory: 15.78GiB freeMemory: 15.37GiB
2019-09-24 13:41:09.007325: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-24 13:41:09.010586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:dc:00.0
totalMemory: 15.78GiB freeMemory: 15.37GiB
2019-09-24 13:41:09.010634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0, 1
2019-09-24 13:41:11.378533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-09-24 13:41:11.378585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 1 
2019-09-24 13:41:11.378595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N Y 
2019-09-24 13:41:11.378603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 1:   Y N 
2019-09-24 13:41:11.379091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14874 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:db:00.0, compute capability: 7.0)
2019-09-24 13:41:11.379529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14874 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:dc:00.0, compute capability: 7.0)
INFO:tensorflow:ckpt /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/data/en-tr/model_save/train_base/model.ckpt-42000
INFO:tensorflow:Reloading model parameters..from /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/data/en-tr/model_save/train_base/model.ckpt-42000
INFO:tensorflow:Restoring parameters from /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/data/en-tr/model_save/train_base/model.ckpt-42000
WARNING:tensorflow:From main_pre_gan.py:230: start_queue_runners (from tensorflow.python.training.queue_runner_impl) is deprecated and will be removed in a future version.
Instructions for updating:
To construct input pipelines, use the `tf.data` module.
WARNING:tensorflow:`tf.train.start_queue_runners()` was called when no queue runners were defined. You can safely remove the call to this deprecated function.
INFO:tensorflow:step = 0, g_loss = 0.2594, x_loss = 0.4819, roll_loss = 12.4169, real_loss = 12.2136, reward = [0.99384975 0.9488142  0.9315427  0.99707806 0.95893705]
INFO:tensorflow:step = 0, g_loss = 0.2471, x_loss = 0.4921, roll_loss = 12.2895, real_loss = 12.1236, reward = [0.987627   0.981449   0.9783764  0.99596083 0.9908169 ]
INFO:tensorflow:step = 0, g_loss = 0.2443, x_loss = 0.4868, roll_loss = 12.3153, real_loss = 12.2819, reward = [0.9855056  1.         1.         0.9927266  0.98407257]
INFO:tensorflow:step = 0, g_loss = 0.1361, x_loss = 0.4858, roll_loss = 12.4271, real_loss = 12.2787, reward = [0.99734366 0.9466648  0.96782196 0.98716813 0.93848675]
INFO:tensorflow:step = 0, g_loss = 0.3548, x_loss = 0.5274, roll_loss = 12.2728, real_loss = 12.1280, reward = [1.         0.9821229  0.99848795 0.97407055 0.97943103]
INFO:tensorflow:------------- Validation step ...0 -----------
INFO:tensorflow:2019-09-24 13:44:04.194271, Step: 0, Valid bleu : 0.117696
INFO:tensorflow:--------------------- Finish evaluation ---------------------
INFO:tensorflow:Saving model at /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/data/en-tr/model_save/train_base_gan/model.ckpt-0
run_pre_gan.sh: line 27: 401819 Killed                  python3 main_pre_gan.py --num_gpus 2 --roll_num 5 --param_set base --data_dir ${BASE_DIR}/data/en-tr/data_total/gen_data --model_dir ${BASE_DIR2}/data/en-tr/model_save/train_base_gan --pretrain_dir /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/data/en-tr/model_save/train_base --learning_rate 2.0 --batch_size 3000 --max_length 50 --fro src --to tgt --save_checkpoints_secs 1200 --train_steps 35000 --steps_between_evals 1000 --extra_decode_length 20
