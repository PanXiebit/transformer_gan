nohup: ignoring input
INFO:tensorflow:flags_obj.model_dir
INFO:tensorflow:source vocab size:28333, target vocab size:29791
WARNING:tensorflow:From /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/utils/dataset.py:41: parallel_interleave (from tensorflow.contrib.data.python.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.experimental.parallel_interleave(...)`.
WARNING:tensorflow:From /home/work/venv/xie_py3.6/lib/python3.6/site-packages/tensorflow/python/ops/sparse_ops.py:1165: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
WARNING:tensorflow:From /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/utils/dataset.py:124: group_by_window (from tensorflow.contrib.data.python.ops.grouping) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.experimental.group_by_window(...)`.
INFO:tensorflow:Build graph on gpu:0
WARNING:tensorflow:From /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/model/beam_search.py:420: calling reduce_logsumexp (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
INFO:tensorflow:roll_num: 0
INFO:tensorflow:roll_num: 1
INFO:tensorflow:roll_num: 2
INFO:tensorflow:roll_num: 3
INFO:tensorflow:roll_num: 4
/home/work/venv/xie_py3.6/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py:112: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
INFO:tensorflow:total trainable variables number: 127, 127
INFO:tensorflow:Build graph on gpu:1
INFO:tensorflow:roll_num: 0
INFO:tensorflow:roll_num: 1
INFO:tensorflow:roll_num: 2
INFO:tensorflow:roll_num: 3
INFO:tensorflow:roll_num: 4
INFO:tensorflow:total trainable variables number: 127, 127
INFO:tensorflow:gradient: IndexedSlices(indices=Tensor("tower_0/gradients/tower_0/Transformer/encode/embedding_weights/embedding/GatherV2_grad/Reshape_1:0", shape=(?,), dtype=int64, device=/device:GPU:0), values=Tensor("tower_0/gradients/tower_0/Transformer/encode/embedding_weights/embedding/GatherV2_grad/Reshape:0", shape=(?, 256), dtype=float32, device=/device:GPU:0), dense_shape=Tensor("tower_0/gradients/tower_0/Transformer/encode/embedding_weights/embedding/GatherV2_grad/ToInt32:0", shape=(2,), dtype=int32, device=/device:CPU:0)), var: <tf.Variable 'Transformer/softmaxsource_embedding/softmax_weights:0' shape=(28333, 256) dtype=float32_ref>
INFO:tensorflow:gradient: IndexedSlices(indices=Tensor("tower_1/gradients/tower_0/Transformer/encode/embedding_weights/embedding_8/GatherV2_grad/Reshape_1:0", shape=(?,), dtype=int64, device=/device:GPU:1), values=Tensor("tower_1/gradients/tower_0/Transformer/encode/embedding_weights/embedding_8/GatherV2_grad/Reshape:0", shape=(?, 256), dtype=float32, device=/device:GPU:1), dense_shape=Tensor("tower_1/gradients/tower_0/Transformer/encode/embedding_weights/embedding_8/GatherV2_grad/ToInt32:0", shape=(2,), dtype=int32, device=/device:CPU:0)), var: <tf.Variable 'Transformer/softmaxsource_embedding/softmax_weights:0' shape=(28333, 256) dtype=float32_ref>
INFO:tensorflow:gradient: IndexedSlices(indices=Tensor("tower_0/gradients/tower_0/Transformer/decode/embedding_weights/embedding/GatherV2_grad/Reshape_1:0", shape=(?,), dtype=int64, device=/device:GPU:0), values=Tensor("tower_0/gradients/tower_0/Transformer/decode/embedding_weights/embedding/GatherV2_grad/Reshape:0", shape=(?, 256), dtype=float32, device=/device:GPU:0), dense_shape=Tensor("tower_0/gradients/tower_0/Transformer/decode/embedding_weights/embedding/GatherV2_grad/ToInt32:0", shape=(2,), dtype=int32, device=/device:CPU:0)), var: <tf.Variable 'Transformer/softmaxtarget_embedding/softmax_weights:0' shape=(29791, 256) dtype=float32_ref>
INFO:tensorflow:gradient: IndexedSlices(indices=Tensor("tower_1/gradients/tower_0/Transformer/decode/embedding_weights/embedding_9/GatherV2_grad/Reshape_1:0", shape=(?,), dtype=int64, device=/device:GPU:1), values=Tensor("tower_1/gradients/tower_0/Transformer/decode/embedding_weights/embedding_9/GatherV2_grad/Reshape:0", shape=(?, 256), dtype=float32, device=/device:GPU:1), dense_shape=Tensor("tower_1/gradients/tower_0/Transformer/decode/embedding_weights/embedding_9/GatherV2_grad/ToInt32:0", shape=(2,), dtype=int32, device=/device:CPU:0)), var: <tf.Variable 'Transformer/softmaxtarget_embedding/softmax_weights:0' shape=(29791, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/presoftmax_linear/MatMul_grad/tuple/control_dependency_1:0", shape=(29791, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/softmaxsot_max/softmax_weights:0' shape=(29791, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_1/Transformer/decode/presoftmax_linear/MatMul_grad/tuple/control_dependency_1:0", shape=(29791, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/softmaxsot_max/softmax_weights:0' shape=(29791, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/layer_normalization/mul_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/layer_normalization/add_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/q/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/k/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/v/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/output_transform/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/layer_normalization/mul_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/layer_normalization/add_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/Tensordot/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/BiasAdd_8_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/Tensordot/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/Tensordot_8/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/BiasAdd_8_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/layer_normalization/mul_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/layer_normalization/add_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/q/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/k/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/v/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/output_transform/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/layer_normalization/mul_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/layer_normalization/add_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/Tensordot/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/BiasAdd_8_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/Tensordot/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/Tensordot_8/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/BiasAdd_8_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/layer_normalization/mul_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/layer_normalization/add_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/q/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/k/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/v/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/output_transform/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/layer_normalization/mul_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/layer_normalization/add_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/Tensordot/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/BiasAdd_8_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/Tensordot/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/Tensordot_8/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/BiasAdd_8_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/layer_normalization/mul_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/layer_normalization/add_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/q/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/k/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/v/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/output_transform/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/layer_normalization/mul_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/layer_normalization/add_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/Tensordot/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/Tensordot_8/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/BiasAdd_8_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/Tensordot/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/Tensordot_8/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/BiasAdd_8_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_normalization/mul_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/encode/encoder_stack/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/encode/encoder_stack/layer_normalization/add_17_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/q/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/k/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/v/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/output_transform/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/q/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/k/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/v/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/output_transform/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/Tensordot/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/BiasAdd_9_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/Tensordot/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/Tensordot_9/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/BiasAdd_9_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/q/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/k/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/v/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/output_transform/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/q/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/k/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/v/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/output_transform/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/Tensordot/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/BiasAdd_9_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/Tensordot/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/Tensordot_9/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/BiasAdd_9_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/q/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/k/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/v/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/output_transform/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/q/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/k/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/v/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/output_transform/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/Tensordot/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/BiasAdd_9_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/Tensordot/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/Tensordot_9/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/BiasAdd_9_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/q/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/k/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/v/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/output_transform/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/q/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/q/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/k/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/k/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/v/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/v/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/output_transform/Tensordot/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/output_transform/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/Tensordot/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/Tensordot_9/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/BiasAdd_9_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/Tensordot/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/Tensordot_9/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/BiasAdd_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/BiasAdd_9_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_normalization/mul_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_normalization/mul_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients/tower_0/Transformer/decode/decoder_stack/layer_normalization/add_1_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients/tower_0/Transformer/decode/decoder_stack/layer_normalization/add_19_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: IndexedSlices(indices=Tensor("tower_0/gradients_1/tower_0/Transformer/encode/embedding_weights/embedding_6/GatherV2_grad/Reshape_1:0", shape=(?,), dtype=int64, device=/device:GPU:0), values=Tensor("tower_0/gradients_1/tower_0/Transformer/encode/embedding_weights/embedding_6/GatherV2_grad/Reshape:0", shape=(?, 256), dtype=float32, device=/device:GPU:0), dense_shape=Tensor("tower_0/gradients_1/tower_0/Transformer/encode/embedding_weights/embedding_6/GatherV2_grad/ToInt32:0", shape=(2,), dtype=int32, device=/device:CPU:0)), var: <tf.Variable 'Transformer/softmaxsource_embedding/softmax_weights:0' shape=(28333, 256) dtype=float32_ref>
INFO:tensorflow:gradient: IndexedSlices(indices=Tensor("tower_1/gradients_1/tower_0/Transformer/encode/embedding_weights/embedding_14/GatherV2_grad/Reshape_1:0", shape=(?,), dtype=int64, device=/device:GPU:1), values=Tensor("tower_1/gradients_1/tower_0/Transformer/encode/embedding_weights/embedding_14/GatherV2_grad/Reshape:0", shape=(?, 256), dtype=float32, device=/device:GPU:1), dense_shape=Tensor("tower_1/gradients_1/tower_0/Transformer/encode/embedding_weights/embedding_14/GatherV2_grad/ToInt32:0", shape=(2,), dtype=int32, device=/device:CPU:0)), var: <tf.Variable 'Transformer/softmaxsource_embedding/softmax_weights:0' shape=(28333, 256) dtype=float32_ref>
INFO:tensorflow:gradient: IndexedSlices(indices=Tensor("tower_0/gradients_1/tower_0/Transformer/decode/embedding_weights/embedding_7/GatherV2_grad/Reshape_1:0", shape=(?,), dtype=int32, device=/device:GPU:0), values=Tensor("tower_0/gradients_1/tower_0/Transformer/decode/embedding_weights/embedding_7/GatherV2_grad/Reshape:0", shape=(?, 256), dtype=float32, device=/device:GPU:0), dense_shape=Tensor("tower_0/gradients_1/tower_0/Transformer/decode/embedding_weights/embedding_7/GatherV2_grad/ToInt32:0", shape=(2,), dtype=int32, device=/device:CPU:0)), var: <tf.Variable 'Transformer/softmaxtarget_embedding/softmax_weights:0' shape=(29791, 256) dtype=float32_ref>
INFO:tensorflow:gradient: IndexedSlices(indices=Tensor("tower_1/gradients_1/tower_0/Transformer/decode/embedding_weights/embedding_16/GatherV2_grad/Reshape_1:0", shape=(?,), dtype=int32, device=/device:GPU:1), values=Tensor("tower_1/gradients_1/tower_0/Transformer/decode/embedding_weights/embedding_16/GatherV2_grad/Reshape:0", shape=(?, 256), dtype=float32, device=/device:GPU:1), dense_shape=Tensor("tower_1/gradients_1/tower_0/Transformer/decode/embedding_weights/embedding_16/GatherV2_grad/ToInt32:0", shape=(2,), dtype=int32, device=/device:CPU:0)), var: <tf.Variable 'Transformer/softmaxtarget_embedding/softmax_weights:0' shape=(29791, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer_7/decode/presoftmax_linear/MatMul_grad/tuple/control_dependency_1:0", shape=(29791, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/softmaxsot_max/softmax_weights:0' shape=(29791, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_1/Transformer_7/decode/presoftmax_linear/MatMul_grad/tuple/control_dependency_1:0", shape=(29791, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/softmaxsot_max/softmax_weights:0' shape=(29791, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/layer_normalization/mul_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/layer_normalization/mul_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/layer_normalization/add_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/layer_normalization/add_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/q/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/q/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/k/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/k/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/v/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/v/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/output_transform/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/self_attention/self_attention/output_transform/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/layer_normalization/mul_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/layer_normalization/mul_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/layer_normalization/add_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/layer_normalization/add_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/BiasAdd_6_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/BiasAdd_14_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/Tensordot_6/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/Tensordot_14/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/BiasAdd_6_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/BiasAdd_14_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_0/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/layer_normalization/mul_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/layer_normalization/mul_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/layer_normalization/add_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/layer_normalization/add_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/q/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/q/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/k/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/k/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/v/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/v/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/output_transform/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/self_attention/self_attention/output_transform/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/layer_normalization/mul_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/layer_normalization/mul_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/layer_normalization/add_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/layer_normalization/add_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/BiasAdd_6_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/BiasAdd_14_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/Tensordot_6/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/Tensordot_14/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/BiasAdd_6_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/BiasAdd_14_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_1/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/layer_normalization/mul_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/layer_normalization/mul_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/layer_normalization/add_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/layer_normalization/add_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/q/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/q/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/k/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/k/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/v/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/v/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/output_transform/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/self_attention/self_attention/output_transform/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/layer_normalization/mul_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/layer_normalization/mul_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/layer_normalization/add_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/layer_normalization/add_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/BiasAdd_6_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/BiasAdd_14_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/Tensordot_6/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/Tensordot_14/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/BiasAdd_6_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/BiasAdd_14_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_2/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/layer_normalization/mul_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/layer_normalization/mul_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/layer_normalization/add_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/layer_normalization/add_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/q/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/q/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/k/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/k/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/v/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/v/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/output_transform/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/self_attention/self_attention/output_transform/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/self_attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/layer_normalization/mul_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/layer_normalization/mul_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/layer_normalization/add_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/layer_normalization/add_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/Tensordot_6/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/Tensordot_14/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/BiasAdd_6_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/BiasAdd_14_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/Tensordot_6/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/Tensordot_14/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/BiasAdd_6_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/BiasAdd_14_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_3/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_normalization/mul_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_normalization/mul_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_normalization/add_13_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/encoder_stack/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/encode/encoder_stack/layer_normalization/add_29_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/encoder_stack/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/q/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/q/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/k/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/k/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/v/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/v/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/output_transform/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/self-attention/self_attention/output_transform/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/q/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/q/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/k/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/k/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/v/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/v/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/output_transform/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/encdec_attention/attention/output_transform/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/BiasAdd_7_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/BiasAdd_16_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/Tensordot_7/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/Tensordot_16/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/BiasAdd_7_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/BiasAdd_16_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_0/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/q/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/q/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/k/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/k/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/v/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/v/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/output_transform/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/self-attention/self_attention/output_transform/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/q/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/q/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/k/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/k/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/v/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/v/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/output_transform/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/encdec_attention/attention/output_transform/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/BiasAdd_7_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/BiasAdd_16_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/Tensordot_7/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/Tensordot_16/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/BiasAdd_7_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/BiasAdd_16_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_1/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/q/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/q/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/k/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/k/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/v/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/v/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/output_transform/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/self-attention/self_attention/output_transform/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/q/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/q/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/k/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/k/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/v/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/v/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/output_transform/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/encdec_attention/attention/output_transform/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/BiasAdd_7_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/BiasAdd_16_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/Tensordot_7/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/Tensordot_16/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/BiasAdd_7_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/BiasAdd_16_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_2/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/q/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/q/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/k/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/k/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/v/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/v/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/output_transform/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/self-attention/self_attention/output_transform/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/self-attention/self_attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/q/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/q/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/q/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/k/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/k/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/k/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/v/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/v/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/v/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/output_transform/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/encdec_attention/attention/output_transform/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/encdec_attention/attention/output_transform/kernel:0' shape=(256, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/Tensordot_7/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/Tensordot_16/transpose_1_grad/transpose:0", shape=(256, 1536), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/kernel:0' shape=(256, 1536) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/BiasAdd_7_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/BiasAdd_16_grad/tuple/control_dependency_1:0", shape=(1536,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/filter_layer/bias:0' shape=(1536,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/Tensordot_7/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/Tensordot_16/transpose_1_grad/transpose:0", shape=(1536, 256), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/kernel:0' shape=(1536, 256) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/BiasAdd_7_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/BiasAdd_16_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_3/ffn/feed_foward_network/output_layer/bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_normalization/mul_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_normalization/mul_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_normalization/layer_norm_scale:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_0/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_normalization/add_15_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:0), var: <tf.Variable 'Transformer/decoder_stack/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
INFO:tensorflow:gradient: Tensor("tower_1/gradients_1/tower_0/Transformer/decode/decoder_stack/layer_normalization/add_33_grad/tuple/control_dependency_1:0", shape=(256,), dtype=float32, device=/device:GPU:1), var: <tf.Variable 'Transformer/decoder_stack/layer_normalization/layer_norm_bias:0' shape=(256,) dtype=float32_ref>
2019-09-24 09:08:59.226137: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-09-24 09:09:00.054182: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-24 09:09:00.055618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:db:00.0
totalMemory: 15.78GiB freeMemory: 15.37GiB
2019-09-24 09:09:00.647674: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-24 09:09:00.649104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:dc:00.0
totalMemory: 15.78GiB freeMemory: 15.37GiB
2019-09-24 09:09:00.649150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0, 1
2019-09-24 09:09:02.568828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-09-24 09:09:02.568880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 1 
2019-09-24 09:09:02.568889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N Y 
2019-09-24 09:09:02.568895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 1:   Y N 
2019-09-24 09:09:02.569394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14874 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:db:00.0, compute capability: 7.0)
2019-09-24 09:09:02.569803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14874 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:dc:00.0, compute capability: 7.0)
INFO:tensorflow:ckpt /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/data/en-tr/model_save/train_base/model.ckpt-42000
INFO:tensorflow:Reloading model parameters..from /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/data/en-tr/model_save/train_base/model.ckpt-42000
INFO:tensorflow:Restoring parameters from /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/data/en-tr/model_save/train_base/model.ckpt-42000
WARNING:tensorflow:From main_pre_gan.py:227: start_queue_runners (from tensorflow.python.training.queue_runner_impl) is deprecated and will be removed in a future version.
Instructions for updating:
To construct input pipelines, use the `tf.data` module.
WARNING:tensorflow:`tf.train.start_queue_runners()` was called when no queue runners were defined. You can safely remove the call to this deprecated function.
INFO:tensorflow:step = 0, g_loss = 0.3203, x_loss = 0.5084, roll_loss = 9.3464, real_loss = 9.3429, reward = [0.997795   0.9977194  0.9966504  0.9999771  0.99872875]
INFO:tensorflow:step = 0, g_loss = 0.2211, x_loss = 0.4948, roll_loss = 9.3675, real_loss = 9.3385, reward = [0.9978391  0.99540216 0.99950516 0.99492455 0.99343264]
INFO:tensorflow:step = 0, g_loss = 0.3201, x_loss = 0.5072, roll_loss = 9.2976, real_loss = 9.2976, reward = [0.9926984  0.99936116 0.9916441  0.9972013  0.9955764 ]
INFO:tensorflow:step = 0, g_loss = 0.3171, x_loss = 0.5034, roll_loss = 9.3511, real_loss = 9.3253, reward = [0.9931838  0.998164   0.9980478  0.9957712  0.99759084]
INFO:tensorflow:step = 0, g_loss = 0.2428, x_loss = 0.5046, roll_loss = 9.3596, real_loss = 9.3393, reward = [0.9961158  0.99838907 0.9963188  0.99947375 0.99935037]
INFO:tensorflow:------------- Validation step ...0 -----------
INFO:tensorflow:2019-09-24 09:11:58.371111, Step: 0, Valid bleu : 0.117716
INFO:tensorflow:--------------------- Finish evaluation ---------------------
INFO:tensorflow:Saving model at /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/data/en-tr/model_save/train_base_gan/model.ckpt-0
INFO:tensorflow:step = 50, g_loss = 0.1464, x_loss = 0.4064, roll_loss = 12.5982, real_loss = 12.4720, reward = [1.         0.9964045  0.9780877  0.95302314 0.997579  ]
INFO:tensorflow:step = 50, g_loss = 0.1363, x_loss = 0.4290, roll_loss = 12.5052, real_loss = 12.2554, reward = [0.97758037 0.9834631  0.9461117  0.98596907 0.996163  ]
INFO:tensorflow:step = 50, g_loss = 0.1895, x_loss = 0.3877, roll_loss = 12.6104, real_loss = 12.3226, reward = [0.99691904 0.8990059  0.9224014  0.9528984  0.99741423]
INFO:tensorflow:step = 50, g_loss = 0.1503, x_loss = 0.4056, roll_loss = 12.5830, real_loss = 12.3463, reward = [0.9977342 0.9960853 0.9756526 0.9801351 0.9947035]
INFO:tensorflow:step = 50, g_loss = 0.1271, x_loss = 0.2532, roll_loss = 12.6250, real_loss = 12.1977, reward = [0.96521634 0.99580944 0.9838834  0.9160937  0.9236129 ]
run_pre_gan.sh: line 27: 325425 Killed                  python3 main_pre_gan.py --num_gpus 2 --roll_num 5 --param_set base --data_dir ${BASE_DIR}/data/en-tr/data_total/gen_data --model_dir ${BASE_DIR2}/data/en-tr/model_save/train_base_gan --pretrain_dir /home/work/xiepan/xp_dial/gan_nmt/transformer_gan/data/en-tr/model_save/train_base --learning_rate 2.0 --batch_size 3000 --max_length 50 --fro src --to tgt --save_checkpoints_secs 1200 --train_steps 35000 --steps_between_evals 1000 --extra_decode_length 20
